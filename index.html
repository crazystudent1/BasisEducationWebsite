<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∞–∑–∏—Å - –ú–µ–≥–∞ –®–∫–æ–ª–∞</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* --- –ì–ª–æ–±–∞–ª—å–Ω—ñ —Å—Ç–∏–ª—ñ --- */
        :root {
            --bg-gradient-start: #5a46a5;
            --bg-gradient-end: #8e7fcf;
            --card-bg: rgba(255, 255, 255, 0.15);
            --card-border: rgba(255, 255, 255, 0.2);
            --text-light: #ffffff;
            
            /* –ö–æ–ª—å–æ—Ä–∏ –ø—Ä–µ–¥–º–µ—Ç—ñ–≤ */
            --color-math: #f1c40f;   /* –ñ–æ–≤—Ç–∏–π */
            --color-geo: #3498db;    /* –°–∏–Ω—ñ–π */
            --color-nature: #2ecc71; /* –ó–µ–ª–µ–Ω–∏–π */
            --color-ukr: #e84393;    /* –†–æ–∂–µ–≤–∏–π */
            --color-eng: #e17055;    /* –ü–æ–º–∞—Ä–∞–Ω—á–µ–≤–∏–π */
            --color-it: #00cec9;     /* –ë—ñ—Ä—é–∑–æ–≤–∏–π */
            --color-logic: #6c5ce7;  /* –§—ñ–æ–ª–µ—Ç–æ–≤–∏–π */
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Nunito', sans-serif; }

        body {
            background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-end));
            color: var(--text-light);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
            user-select: none;
        }

        #app-container { max-width: 1200px; margin: 0 auto; width: 100%; }

        /* –ê–Ω—ñ–º–∞—Ü—ñ—ó */
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 40% {transform: translateY(-30px);} 60% {transform: translateY(-15px);} }
        @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-5px); } 50% { transform: translateX(5px); } 75% { transform: translateX(-5px); } 100% { transform: translateX(0); } }
        @keyframes pop { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

        .anim-correct { animation: bounce 1s; }
        .anim-wrong { animation: shake 0.4s; }
        .anim-pop { animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

        /* UI –ï–ª–µ–º–µ–Ω—Ç–∏ */
        .glass-button {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            padding: 10px 20px;
            border-radius: 20px;
            color: var(--text-light);
            font-weight: 700;
            backdrop-filter: blur(10px);
            cursor: pointer;
            transition: 0.3s;
            display: flex; align-items: center; gap: 10px;
        }
        .glass-button:hover { background: rgba(255, 255, 255, 0.25); transform: translateY(-2px); }
        .glass-button:disabled { opacity: 0.5; cursor: not-allowed; }

        .glass-card {
            background: var(--card-bg);
            border: 2px solid var(--card-border);
            border-radius: 25px;
            padding: 25px;
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            margin-bottom: 20px;
        }

        /* –ù–∞–≤—ñ–≥–∞—Ü—ñ—è */
        .top-nav { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; flex-wrap: wrap; gap: 10px; }
        .hearts-display { font-size: 1.5rem; background: rgba(0,0,0,0.2); padding: 5px 15px; border-radius: 20px; letter-spacing: 5px; }

        /* –°—ñ—Ç–∫–∞ –ø—Ä–µ–¥–º–µ—Ç—ñ–≤ */
        .shop-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; }
        .shop-item { 
            text-align: center; border: 2px solid transparent; transition: 0.3s; cursor: pointer;
            display: flex; flex-direction: column; justify-content: center; min-height: 180px;
        }
        .shop-item:hover { border-color: #ffd700; background: rgba(255,255,255,0.25); transform: translateY(-5px); }

        /* –ö–≤—ñ–∑ */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); backdrop-filter: blur(5px);
            display: flex; justify-content: center; align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background: #2c2c54; border: 2px solid #5a46a5;
            padding: 30px; border-radius: 25px; max-width: 500px; width: 90%;
            text-align: center; color: white;
            box-shadow: 0 0 50px rgba(90, 70, 165, 0.5);
        }
        
        .option-btn {
            width: 100%; background: rgba(255, 255, 255, 0.95); color: #333;
            border: none; padding: 18px; margin-bottom: 12px; border-radius: 15px;
            font-size: 1.1rem; font-weight: 700; cursor: pointer;
            box-shadow: 0 4px 0 #ccc; transition: 0.1s;
        }
        .option-btn:active { transform: translateY(4px); box-shadow: none; }
        .option-btn.correct { background: #2ecc71; color: white; box-shadow: 0 4px 0 #27ae60; }
        .option-btn.wrong { background: #e74c3c; color: white; box-shadow: 0 4px 0 #c0392b; }

        .avatar-img {
            width: 100px; height: 100px; background-color: #ffd900;
            border-radius: 25px; border: 4px solid rgba(255,255,255,0.5);
            display: flex; align-items: center; justify-content: center;
            font-size: 3.5rem; margin: 0 auto 15px;
        }
        .avatar-img.premium { background: linear-gradient(45deg, #ff00cc, #333399); box-shadow: 0 0 15px #ff00cc; border-color: white;}
    </style>
</head>
<body>

    <div id="app-container">
        <nav class="top-nav">
            <div style="display: flex; gap: 10px;">
                <button class="glass-button" onclick="showHome()">üè† –ì–æ–ª–æ–≤–Ω–∞</button>
                <button class="glass-button" onclick="showShop()">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
            </div>
            <div class="hearts-display" id="hearts-display">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
            <button class="glass-button" onclick="showProfile()">
                <span id="user-coins-display">üí∞ 0</span> 
                <span style="margin-left:10px;">üë§ –ü—Ä–æ—Ñ—ñ–ª—å</span>
            </button>
        </nav>

        <main id="app"></main>
    </div>

    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3"></audio>
    <audio id="sound-win" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3"></audio>

    <script>
        /* --- 1. –†–û–ó–®–ò–†–ï–ù–ê –ë–ê–ó–ê –î–ê–ù–ò–• --- */
        const quizData = {
            math: {
                title: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞", color: "var(--color-math)", icon: "‚ûó",
                theory: "–ú–Ω–æ–∂–µ–Ω–Ω—è ‚Äî —Ü–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ –∂ —á–∏—Å–ª–∞ –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤. 3 * 4 ‚Äî —Ü–µ —è–∫ 3 + 3 + 3 + 3.",
                questions: [
                    { q: "–°–∫—ñ–ª—å–∫–∏ –±—É–¥–µ 6 + 6?", a: ["10", "12", "14", "11"], correct: 1, explain: "6 + 4 = 10, —ñ —â–µ + 2 = 12." },
                    { q: "–°–∫—ñ–ª—å–∫–∏ –∫—É—Ç—ñ–≤ —É –∫–≤–∞–¥—Ä–∞—Ç–∞?", a: ["3", "4", "5", "10"], correct: 1, explain: "–£ –∫–≤–∞–¥—Ä–∞—Ç–∞ –∑–∞–≤–∂–¥–∏ 4 —Ä—ñ–≤–Ω–∏—Ö —Å—Ç–æ—Ä–æ–Ω–∏ —ñ 4 –∫—É—Ç–∏." },
                    { q: "10 –º—ñ–Ω—É—Å 3?", a: ["6", "7", "8", "5"], correct: 1, explain: "–Ø–∫—â–æ –≤—ñ–¥ 10 –ø–∞–ª—å—Ü—ñ–≤ –∑–∞–±—Ä–∞—Ç–∏ 3, –∑–∞–ª–∏—à–∏—Ç—å—Å—è 7." }
                ]
            },
            ukr: {
                title: "–£–∫—Ä. –ú–æ–≤–∞", color: "var(--color-ukr)", icon: "üìö",
                theory: "–Ü–º–µ–Ω–Ω–∏–∫ ‚Äî —Ü–µ —á–∞—Å—Ç–∏–Ω–∞ –º–æ–≤–∏, —â–æ –æ–∑–Ω–∞—á–∞—î –ø—Ä–µ–¥–º–µ—Ç —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è: –•—Ç–æ? –∞–±–æ –©–æ? (–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –∫—ñ—Ç, —Å—Ç—ñ–ª).",
                questions: [
                    { q: "–Ø–∫–µ —Å–ª–æ–≤–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è –•—Ç–æ?", a: ["–°—Ç—ñ–ª", "–î–µ—Ä–µ–≤–æ", "–®–∫–æ–ª—è—Ä", "–°–æ–Ω—Ü–µ"], correct: 2, explain: "–®–∫–æ–ª—è—Ä ‚Äî —Ü–µ –∂–∏–≤–∞ –ª—é–¥–∏–Ω–∞, —Ç–æ–º—É '–•—Ç–æ?'. –Ü–Ω—à–µ ‚Äî —Ü–µ '–©–æ?'." },
                    { q: "–ê–Ω—Ç–æ–Ω—ñ–º –¥–æ —Å–ª–æ–≤–∞ '–î–µ–Ω—å'?", a: ["–†–∞–Ω–æ–∫", "–ù—ñ—á", "–°–≤—ñ—Ç–ª–æ", "–í–µ—á—ñ—Ä"], correct: 1, explain: "–ê–Ω—Ç–æ–Ω—ñ–º ‚Äî —Ü–µ –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è. –ü—Ä–æ—Ç–∏–ª–µ–∂–Ω—ñ—Å—Ç—å –¥–Ω—è ‚Äî —Ü–µ –Ω—ñ—á." },
                    { q: "–°–∫—ñ–ª—å–∫–∏ –±—É–∫–≤ –≤ –∞–ª—Ñ–∞–≤—ñ—Ç—ñ?", a: ["33", "32", "26", "30"], correct: 0, explain: "–í —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ–º—É –∞–ª—Ñ–∞–≤—ñ—Ç—ñ —Ä—ñ–≤–Ω–æ 33 –ª—ñ—Ç–µ—Ä–∏." }
                ]
            },
            eng: {
                title: "English", color: "var(--color-eng)", icon: "üá¨üáß",
                theory: "–í –∞–Ω–≥–ª—ñ–π—Å—å–∫—ñ–π –º–æ–≤—ñ 'Hello' –æ–∑–Ω–∞—á–∞—î –ü—Ä–∏–≤—ñ—Ç, –∞ 'Goodbye' ‚Äî –î–æ –ø–æ–±–∞—á–µ–Ω–Ω—è.",
                questions: [
                    { q: "–Ø–∫ –ø–µ—Ä–µ–∫–ª–∞–¥–∞—î—Ç—å—Å—è 'Cat'?", a: ["–°–æ–±–∞–∫–∞", "–ö—ñ—Ç", "–ú–∏—à–∞", "–ü—Ç–∞—Ö"], correct: 1, explain: "Cat ‚Äî —Ü–µ –∫–æ—Ç–∏–∫. –°–æ–±–∞–∫–∞ –±—É–¥–µ Dog." },
                    { q: "–Ø–∫–∏–π —Ü–µ –∫–æ–ª—ñ—Ä: 'Red'?", a: ["–°–∏–Ω—ñ–π", "–ó–µ–ª–µ–Ω–∏–π", "–ß–µ—Ä–≤–æ–Ω–∏–π", "–ñ–æ–≤—Ç–∏–π"], correct: 2, explain: "Red ‚Äî —Ü–µ —á–µ—Ä–≤–æ–Ω–∏–π –∫–æ–ª—ñ—Ä." },
                    { q: "–©–æ –æ–∑–Ω–∞—á–∞—î 'Thank you'?", a: ["–ë—É–¥—å –ª–∞—Å–∫–∞", "–í–∏–±–∞—á", "–ü—Ä–∏–≤—ñ—Ç", "–î—è–∫—É—é"], correct: 3, explain: "–ú–∏ –∫–∞–∂–µ–º–æ Thank you, –∫–æ–ª–∏ –¥—è–∫—É—î–º–æ –∫–æ–º—É—Å—å." }
                ]
            },
            geo: {
                title: "–ì–µ–æ–≥—Ä–∞—Ñ—ñ—è", color: "var(--color-geo)", icon: "üåç",
                theory: "–ì–ª–æ–±—É—Å ‚Äî —Ü–µ –º–æ–¥–µ–ª—å –ó–µ–º–ª—ñ. –ù–∞ –Ω—å–æ–º—É —Å–∏–Ω—ñ–º –∫–æ–ª—å–æ—Ä–æ–º –ø–æ–∑–Ω–∞—á–∞—é—Ç—å –≤–æ–¥—É, –∞ —ñ–Ω—à–∏–º–∏ –∫–æ–ª—å–æ—Ä–∞–º–∏ ‚Äî —Å—É—à—É.",
                questions: [
                    { q: "–°—Ç–æ–ª–∏—Ü—è –£–∫—Ä–∞—ó–Ω–∏?", a: ["–õ—å–≤—ñ–≤", "–û–¥–µ—Å–∞", "–ö–∏—ó–≤", "–•–∞—Ä–∫—ñ–≤"], correct: 2, explain: "–ö–∏—ó–≤ ‚Äî —Å–µ—Ä—Ü–µ –Ω–∞—à–æ—ó –¥–µ—Ä–∂–∞–≤–∏." },
                    { q: "–ù–∞–π–±—ñ–ª—å—à–∞ —Ä—ñ—á–∫–∞ –£–∫—Ä–∞—ó–Ω–∏?", a: ["–î—É–Ω–∞–π", "–î–Ω—ñ–ø—Ä–æ", "–î–µ—Å–Ω–∞", "–î–Ω—ñ—Å—Ç–µ—Ä"], correct: 1, explain: "–î–Ω—ñ–ø—Ä–æ ‚Äî –Ω–∞–π–¥–æ–≤—à–∞ —ñ –Ω–∞–π–±—ñ–ª—å—à–∞ —Ä—ñ—á–∫–∞, —â–æ —Ç–µ—á–µ —á–µ—Ä–µ–∑ –ö–∏—ó–≤." }
                ]
            },
            it: {
                title: "–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞", color: "var(--color-it)", icon: "üíª",
                theory: "–ö–æ–º–ø'—é—Ç–µ—Ä —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –º–æ–Ω—ñ—Ç–æ—Ä–∞ (—â–æ–± –±–∞—á–∏—Ç–∏), –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ (—â–æ–± –ø–∏—Å–∞—Ç–∏) —Ç–∞ –º–∏—à–∫–∏ (—â–æ–± –∫–µ—Ä—É–≤–∞—Ç–∏).",
                questions: [
                    { q: "–ß–∏–º –º–∏ –≤–≤–æ–¥–∏–º–æ —Ç–µ–∫—Å—Ç?", a: ["–ú–∏—à–∫–æ—é", "–ú–æ–Ω—ñ—Ç–æ—Ä–æ–º", "–ö–ª–∞–≤—ñ–∞—Ç—É—Ä–æ—é", "–ü—Ä–∏–Ω—Ç–µ—Ä–æ–º"], correct: 2, explain: "–ù–∞ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—ñ —î –±–∞–≥–∞—Ç–æ –∫–Ω–æ–ø–æ–∫ –∑ –ª—ñ—Ç–µ—Ä–∞–º–∏." },
                    { q: "–©–æ —Ç–∞–∫–µ '–Ü–Ω—Ç–µ—Ä–Ω–µ—Ç'?", a: ["–ì—Ä–∞", "–í—Å–µ—Å–≤—ñ—Ç–Ω—è –º–µ—Ä–µ–∂–∞", "–ü—Ä–æ–≥—Ä–∞–º–∞", "–ú–∞–≥–∞–∑–∏–Ω"], correct: 1, explain: "–Ü–Ω—Ç–µ—Ä–Ω–µ—Ç –∑'—î–¥–Ω—É—î –≤—Å—ñ –∫–æ–º–ø'—é—Ç–µ—Ä–∏ —Å–≤—ñ—Ç—É –≤ –æ–¥–Ω—É –º–µ—Ä–µ–∂—É." }
                ]
            },
            nature: {
                title: "–ü—Ä–∏—Ä–æ–¥–∞", color: "var(--color-nature)", icon: "üåø",
                theory: "–†–æ—Å–ª–∏–Ω–∏ –∂–∏–≤—ñ. –í–æ–Ω–∏ –ø'—é—Ç—å –≤–æ–¥—É –∫–æ—Ä—ñ–Ω–Ω—è–º —ñ –¥–∏—Ö–∞—é—Ç—å –ª–∏—Å—Ç—è–º. –á–º –ø–æ—Ç—Ä—ñ–±–Ω–µ —Å–æ–Ω—Ü–µ –¥–ª—è —Ä–æ—Å—Ç—É.",
                questions: [
                    { q: "–•—Ç–æ –≤–ø–∞–¥–∞—î –≤ —Å–ø–ª—è—á–∫—É –≤–∑–∏–º–∫—É?", a: ["–ó–∞—î—Ü—å", "–í–µ–¥–º—ñ–¥—å", "–í–æ–≤–∫", "–ì–æ—Ä–æ–±–µ—Ü—å"], correct: 1, explain: "–í–µ–¥–º–µ–¥—ñ —Å–ø–ª—è—Ç—å —É –±–∞—Ä–ª–æ–∑—ñ –≤—Å—é –∑–∏–º—É." },
                    { q: "–©–æ –¥–∞—î –Ω–∞–º –∫–æ—Ä–æ–≤–∞?", a: ["–Ø–π—Ü—è", "–ú–æ–ª–æ–∫–æ", "–í–æ–≤–Ω—É", "–ú–µ–¥"], correct: 1, explain: "–ö–æ—Ä–æ–≤–∞ –¥–∞—î –º–æ–ª–æ–∫–æ. –Ø–π—Ü—è ‚Äî –∫—É—Ä–∫–∞, –º–µ–¥ ‚Äî –±–¥–∂–æ–ª–∞." }
                ]
            },
            logic: {
                title: "–õ–æ–≥—ñ–∫–∞", color: "var(--color-logic)", icon: "üß©",
                theory: "–õ–æ–≥—ñ–∫–∞ –≤—á–∏—Ç—å –Ω–∞—Å –¥—É–º–∞—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ. –Ø–∫—â–æ —Å—å–æ–≥–æ–¥–Ω—ñ –≤—ñ–≤—Ç–æ—Ä–æ–∫, —Ç–æ –≤—á–æ—Ä–∞ –±—É–≤ –ø–æ–Ω–µ–¥—ñ–ª–æ–∫, –∞ –∑–∞–≤—Ç—Ä–∞ –±—É–¥–µ —Å–µ—Ä–µ–¥–∞.",
                questions: [
                    { q: "–©–æ –∑–∞–π–≤–µ: –Ø–±–ª—É–∫–æ, –ì—Ä—É—à–∞, –ú'—è—á, –ë–∞–Ω–∞–Ω?", a: ["–Ø–±–ª—É–∫–æ", "–ú'—è—á", "–ë–∞–Ω–∞–Ω", "–ì—Ä—É—à–∞"], correct: 1, explain: "–ú'—è—á ‚Äî —Ü–µ —ñ–≥—Ä–∞—à–∫–∞, –∞ –≤—Å–µ —ñ–Ω—à–µ ‚Äî —Ñ—Ä—É–∫—Ç–∏." },
                    { q: "–ü—Ä–æ–¥–æ–≤–∂ —Ä—è–¥: 2, 4, 6, 8, ...?", a: ["9", "10", "11", "12"], correct: 1, explain: "–ú–∏ –¥–æ–¥–∞—î–º–æ –ø–æ 2: 8 + 2 = 10." }
                ]
            }
        };

        // –°—Ç–∞–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
        let userStats = {
            coins: 1200, level: 5, hearts: 5, maxHearts: 5, 
            inventory: [], achievements: ["newbie"]
        };

        const app = document.getElementById('app');
        const heartsDisplay = document.getElementById('hearts-display');
        const coinsDisplay = document.getElementById('user-coins-display');

        /* --- 2. –§–£–ù–ö–¶–Ü–û–ù–ê–õ --- */
        function playSound(type) {
            const sound = document.getElementById(`sound-${type}`);
            if (sound) { sound.currentTime = 0; sound.volume = 0.3; sound.play().catch(()=>{}); }
        }

        function updateHeader() {
            let heartsStr = "";
            for(let i=0; i<userStats.maxHearts; i++) heartsStr += i < userStats.hearts ? "‚ù§Ô∏è" : "üñ§";
            heartsDisplay.textContent = heartsStr;
            coinsDisplay.textContent = `üí∞ ${userStats.coins}`;
        }

        /* –ï–∫—Ä–∞–Ω–∏ */
        function showHome() {
            updateHeader();
            app.innerHTML = `
                <div class="glass-card anim-pop" style="text-align: center;">
                    <h1>üéì –û–±–∏—Ä–∞–π —É—Ä–æ–∫</h1>
                    <p style="color: var(--text-muted)">–í—ñ–¥–∫—Ä–∏–π –¥–ª—è —Å–µ–±–µ –Ω–æ–≤—ñ –∑–Ω–∞–Ω–Ω—è!</p>
                </div>
                <div class="shop-grid"> 
                    ${Object.keys(quizData).map(key => {
                        const item = quizData[key];
                        return `
                        <div class="glass-card shop-item" onclick="initQuiz('${key}')" style="border-bottom: 5px solid ${item.color}">
                            <div style="font-size: 3.5rem; margin-bottom: 15px;">${item.icon}</div>
                            <h3 style="color: ${item.color}; font-weight:800;">${item.title}</h3>
                        </div>`;
                    }).join('')}
                </div>
            `;
        }

        function showShop() {
            updateHeader();
            app.innerHTML = `
                <div class="glass-card anim-pop" style="text-align: center;">
                    <h2 style="color: #ffd700;">üõí –ú–∞–≥–∞–∑–∏–Ω</h2>
                    <p>–¢–≤–æ—ó –º–æ–Ω–µ—Ç–∏: ${userStats.coins}</p>
                </div>
                <div class="shop-grid">
                    <div class="glass-card shop-item">
                        <div style="font-size: 3rem;">‚ù§Ô∏è</div>
                        <h3>–ü–æ–≤–Ω–µ –∑–¥–æ—Ä–æ–≤'—è</h3>
                        <div style="color: #ffd700; font-weight:bold; margin:10px;">100 üí∞</div>
                        <button class="glass-button" style="width:100%; justify-content:center;" onclick="buyItem('heart', 100)">–ö—É–ø–∏—Ç–∏</button>
                    </div>
                    <div class="glass-card shop-item">
                        <div style="font-size: 3rem;">üëæ</div>
                        <h3>–ö—ñ–±–µ—Ä-–ê–≤–∞—Ç–∞—Ä</h3>
                        <div style="color: #ffd700; font-weight:bold; margin:10px;">500 üí∞</div>
                        <button class="glass-button" style="width:100%; justify-content:center;" 
                                ${userStats.inventory.includes('premium_skin') ? 'disabled' : ''}
                                onclick="buyItem('premium_skin', 500)">
                                ${userStats.inventory.includes('premium_skin') ? '–Ñ —É —Ç–µ–±–µ' : '–ö—É–ø–∏—Ç–∏'}
                        </button>
                    </div>
                </div>
            `;
        }

        function buyItem(item, price) {
            if (userStats.coins >= price) {
                if (item === 'heart') {
                    if (userStats.hearts >= userStats.maxHearts) return alert("–ñ–∏—Ç—Ç—è —ñ —Ç–∞–∫ –ø–æ–≤–Ω—ñ!");
                    userStats.hearts = userStats.maxHearts;
                } else if (item === 'premium_skin') {
                    userStats.inventory.push('premium_skin');
                }
                userStats.coins -= price;
                playSound('correct');
                confetti({ particleCount: 50, spread: 60, origin: { y: 0.6 } });
                showShop();
            } else {
                playSound('wrong');
                alert("–ú–∞–ª–æ –º–æ–Ω–µ—Ç! –¢—Ä–µ–±–∞ –±—ñ–ª—å—à–µ –≤—á–∏—Ç–∏—Å—è!");
            }
        }

        function showProfile() {
            const hasSkin = userStats.inventory.includes('premium_skin');
            app.innerHTML = `
                <div class="glass-card anim-pop" style="text-align:center;">
                    <div class="avatar-img ${hasSkin ? 'premium' : ''}">${hasSkin ? 'üëæ' : 'ü§ì'}</div>
                    <h2>–ú—ñ–π –ü—Ä–æ—Ñ—ñ–ª—å</h2>
                    <p>–†—ñ–≤–µ–Ω—å –∑–Ω–∞–Ω—å: ${userStats.level}</p>
                </div>
                <div class="glass-card">
                    <h3>üèÜ –¢–≤–æ—ó –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è</h3>
                    <div style="display:flex; gap:15px; flex-wrap:wrap; justify-content:center; margin-top:15px;">
                        <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:10px; width:80px; text-align:center;">
                            <div style="font-size:2rem;">üåÖ</div><small>–ü–æ—á–∞—Ç–æ–∫</small>
                        </div>
                        <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:10px; width:80px; text-align:center; opacity:0.5;">
                            <div style="font-size:2rem;">üß†</div><small>–†–æ–∑—É–º–Ω–∏–∫</small>
                        </div>
                    </div>
                </div>
            `;
        }

        /* –õ–û–ì–Ü–ö–ê –¢–ï–°–¢–£–í–ê–ù–ù–Ø */
        function initQuiz(key) {
            if (userStats.hearts <= 0) return alert("üíî –ù–µ–º–∞—î –∂–∏—Ç—Ç—ñ–≤! –ö—É–ø–∏ –≤ –º–∞–≥–∞–∑–∏–Ω—ñ."), showShop();
            const cat = quizData[key];
            app.innerHTML += `
                <div class="modal-overlay">
                    <div class="modal-content anim-pop">
                        <h2 style="color:${cat.color}">üìö –£—Ä–æ–∫: ${cat.title}</h2>
                        <div style="background:rgba(255,255,255,0.1); padding:15px; border-radius:15px; margin:20px 0; text-align:left; line-height:1.5;">${cat.theory}</div>
                        <button class="glass-button" style="width:100%; justify-content:center; background:${cat.color};" onclick="startQuiz('${key}')">–†–æ–∑–ø–æ—á–∞—Ç–∏!</button>
                    </div>
                </div>
            `;
        }

        function startQuiz(key) {
            const cat = quizData[key];
            const questions = cat.questions;
            let idx = 0;

            function render() {
                if (idx >= questions.length) return finishQuiz();
                if (userStats.hearts <= 0) return showHome();

                const q = questions[idx];
                const hasSkin = userStats.inventory.includes('premium_skin');
                
                app.innerHTML = `
                    <div class="glass-card anim-pop" style="text-align:center; max-width:600px; margin:0 auto;">
                        <div id="q-avatar" class="avatar-img ${hasSkin ? 'premium' : ''}" style="width:80px; height:80px; font-size:3rem;">${hasSkin ? 'üëæ' : 'ü§ì'}</div>
                        <h2 style="color:${cat.color}; margin-bottom:20px;">${cat.title}</h2>
                        <div style="font-size:1.4rem; font-weight:700; margin-bottom:25px; min-height:60px;">${q.q}</div>
                        <div>
                            ${q.a.map((opt, i) => `<button class="option-btn" onclick="checkAnswer(${i}, ${q.correct}, '${q.explain}')">${opt}</button>`).join('')}
                        </div>
                        <button class="glass-button" style="margin-top:20px;" onclick="showHome()">–í–∏–π—Ç–∏</button>
                    </div>
                `;
            }

            window.checkAnswer = (sel, cor, expl) => {
                const btns = document.querySelectorAll('.option-btn');
                const avatar = document.getElementById('q-avatar');
                btns.forEach(b => b.disabled = true);

                if (sel === cor) {
                    btns[sel].classList.add('correct');
                    avatar.classList.add('anim-correct');
                    avatar.innerHTML = "üòé";
                    playSound('correct');
                    userStats.coins += 15;
                    setTimeout(() => { idx++; render(); }, 1500);
                } else {
                    btns[sel].classList.add('wrong');
                    avatar.classList.add('anim-wrong');
                    avatar.innerHTML = "ü•∫";
                    playSound('wrong');
                    userStats.hearts--;
                    updateHeader();
                    
                    setTimeout(() => {
                        const modal = document.createElement('div');
                        modal.className = 'modal-overlay';
                        modal.innerHTML = `
                            <div class="modal-content anim-wrong">
                                <h2 style="color:#e74c3c">–ü–æ–º–∏–ª–∫–∞! üò¨</h2>
                                <p style="margin:15px 0; font-size:1.1rem;">${expl}</p>
                                <button class="glass-button" style="width:100%; justify-content:center;" onclick="this.closest('.modal-overlay').remove(); idx++; render();">–î–∞–ª—ñ</button>
                            </div>`;
                        document.body.appendChild(modal);
                    }, 800);
                }
            };
            render();
        }

        function finishQuiz() {
            playSound('win');
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
            app.innerHTML = `
                <div class="glass-card anim-pop" style="text-align:center; padding:40px;">
                    <div style="font-size:5rem;">üéâ</div>
                    <h2>–ú–æ–ª–æ–¥–µ—Ü—å!</h2>
                    <p>–¢–∏ –∑–∞–∫—ñ–Ω—á–∏–≤ —Ü–µ–π —É—Ä–æ–∫.</p>
                    <div style="margin:20px 0; font-size:1.5rem; color:#ffd700; font-weight:bold;">+50 –ú–æ–Ω–µ—Ç</div>
                    <button class="glass-button" style="width:100%; justify-content:center;" onclick="showHome()">–í –º–µ–Ω—é</button>
                </div>
            `;
            userStats.coins += 50;
            updateHeader();
        }

        showHome();
    </script>
</body>
</html>